{% extends "base.html" %}
{% block title %}Controls{% endblock %}

{% block content %}
  <div class="page-title">
    <h1>Controls (Framework Library)</h1>
  </div>

  <div class="wrap">
    <section class="panel" style="padding:1rem; overflow-x:auto;">
      <!-- Give the table a sensible min width so Name/Actions don't collapse -->
      <table style="width:100%; min-width: 1200px; border-collapse:collapse; table-layout:fixed;">
        <thead>
          <tr style="background:#f2f8f2;">
            <th style="width:26%; text-align:left; padding:.6rem .5rem;">Framework</th>
            <th style="width:18%; text-align:left; padding:.6rem .5rem;">Ref</th>
            <th style="width:36%; text-align:left; padding:.6rem .5rem;">Name</th>
            <th style="width:20%; text-align:left; padding:.6rem .5rem;">Controls</th>
          </tr>
        </thead>
        <tbody>
          {% for c in controls %}
            <tr style="border-bottom:1px solid #e0e8e0;">
              <!-- Framework -->
              <td style="padding:.55rem .5rem; vertical-align:top; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
                {{ c.framework or 'â€”' }}{% if c.version %} <span class="muted">({{ c.version }})</span>{% endif %}
              </td>

              <!-- Ref -->
              <td style="padding:.55rem .5rem; vertical-align:top; white-space:nowrap;">
                {{ c.ref }}
              </td>

              <!-- Name (+ tiny desc preview if present) -->
              <td style="padding:.55rem .5rem; vertical-align:top; overflow:hidden;">
                <div style="font-weight:600; margin-bottom:.25rem;">{{ c.name }}</div>
                {% if c.description %}
                  <div class="muted" style="font-size:.9rem; line-height:1.3; max-height:3.1em; overflow:hidden; text-overflow:ellipsis;">
                    {{ c.description }}
                  </div>
                {% endif %}
              </td>

              <!-- Link to org controls overview -->
              <td style="padding:.55rem .5rem; vertical-align:top;">
                <a
                  class="btn small"
                  href="/orgs/{{ org_id or 1 }}/controls"
                  title="View all organisation & site controls"
                >
                  View organisation controls
                </a>
                <div class="muted" style="margin-top:.35rem; font-size:.85rem;">
                  Org-wide and site-level view.
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </div>
{% endblock %}
